<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crear Cuenta - Restaurante Liz</title>
    <link rel="stylesheet" href="crear_cuenta.css">
</head>
<body>
    <div id="app" class="container">
        <header>
            <h1>Crear Cuenta</h1>
        </header>
        <main>
            <form class="signup-form">
                
                <label for="email"><b>Correo Electrónico:</b></label>
                <input type="email" id="email" placeholder="Correo Electrónico">

                <label for="usuario"><b>Usuario:</b></label>
                <input type="text" id="username" placeholder="Usuario">
                
                
                <label for="password"><b>Contraseña:</b></label>
                <input type="password" id="password" placeholder="Contraseña">
                
                <label for="show-password">Mostrar contraseña: </label>
                <input type="checkbox" id="show-password">
                <small id="password-hint" class="form-hint">La contraseña debe tener al menos 8 caracteres, incluyendo al menos una mayúscula, una minúscula, un número y un carácter especial.</small>

                <button type="submit" @click="crear()" id="signup-btn">Crear Cuenta</button>
            </form>
            <div id="message"></div>
        </main>
    </div>
</body>

<script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.20.0/axios.js"
  integrity="sha512-nqIFZC8560+CqHgXKez61MI0f9XSTKLkm0zFVm/99Wt0jSTZ7yeeYwbzyl0SGn/s8Mulbdw+ScCG41hmO2+FKw=="
  crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.0.2/dist/sweetalert2.all.min.js"></script>

<script>
  let url = 'http://localhost:4000/users';
  new Vue({
    el: '#app',
    vuetify: new Vuetify(),
    data() {
      return {
        userss: [],
        users: {
          id: null,
          nombre: '',
          correo: '',
          contrasena: '',
          tipo: '',
          contador: ''
        }
      }
    },
    created() {
      this.mostrar()
    },
    methods: {
      //MÉTODOS PARA EL CRUD
      mostrar: function () {
        axios.get(url)
          .then(response => {
            this.userss = response.data;
            
          })
      },
      crear: function () {
        event.preventDefault();
        var usuarioc = document.getElementById("username").value;
        var password = document.getElementById("password").value;
        var email = document.getElementById("email").value;

        let parametros = { nombre: usuarioc, correo: email, contrasena: password, tipo: 1, contador: 0 };
        axios.post(url, parametros)
          .then(response => {
            this.mostrar();
          });
        this.users.nombre = "";
        this.users.correo = "";
        this.users.contrasena = "";
        this.users.tipo = "";
        this.users.contador = "";
        alert("Usuario creado");
      },
      editar: function () {
        let parametros = { nombre: this.users.nombre, correo: this.users.correo, contrasena: this.users.contrasena, tipo: this.users.tipo, contador: this.users.contador  };
        //console.log(parametros);                   
        axios.put(url + "/" + this.users.id, parametros)
          .then(response => {
            this.mostrar();
          })
          .catch(error => {
            console.log(error);
          });
      },
      borrar: function (id) {
        Swal.fire({
          title: '¿Confirma eliminar el registro?',
          confirmButtonText: `Confirmar`,
          showCancelButton: true,
        }).then((result) => {
          if (result.isConfirmed) {
            //procedimiento borrar
            axios.delete(url + "/" + id)
              .then(response => {
                this.mostrar();
              });
            Swal.fire('¡Eliminado!', '', 'success')
          } else if (result.isDenied) {
          }
        });
      },
    }
  });
</script>

</html>
